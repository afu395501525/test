this.Clue=this.Clue||{},this.Clue.Loader=function(){"use strict";var e={revison:"b7de3fb6",time:"2019-06-05 15:18:26",timestamp:1559719106900},o="vendor.758d75.js",n="activity.49a645.js",t="lottery.682156.js",a="lottery2.4d6df2.js",r="phone.1d5f71.js",l="phone.1d5f71.js",c="consult.85a587.js",d="normalForm.41f18c.js",i="creativeForm.2b4199.js",u="commonCaptcha.ba0ef7.js",s="commonCreativeCaptcha.7ebe54.js",m="paySDK.fc96ff.js",p=("http:"===location.protocol?"http:":"https:")+"//s3.pstatp.com/bytecom/resource/clueapp/",v={vendor:p+o,activity:p+n,lottery:p+t,lottery2:p+a,phone:p+r,phoneEvent:p+l,consultEvent:p+c,normalForm:p+d,creativeForm:p+i,commonCaptcha:p+u,commonCreativeCaptcha:p+s,paySDK:p+m},h={vendor:{name:"Vendor",url:p+o,deps:[],loaded:!1},activity:{name:"Activity",url:p+n,deps:["vendor"],loaded:!1},lotteryOld:{name:"LotteryOld",url:p+"lottery.c43196.js",deps:[""],loadPromise:null,loaded:!1,oldName:"ClueLotteryApp"},lottery:{name:"Lottery",url:p+t,deps:["vendor"],loadPromise:null,loaded:!1},lottery2:{name:"Lottery2",url:p+a,deps:["vendor"],loadPromise:null,loaded:!1},phone:{name:"Phone",url:p+r,deps:["vendor"],loaded:!1,oldName:"phoneapp"},consult:{name:"Consult",url:p+c,deps:[],loaded:!1},normalForm:{name:"NormalForm",url:p+d,deps:["vendor"],loaded:!1,oldName:"ClueNormalFormApp"},creativeForm:{name:"CreativeForm",url:p+i,deps:["vendor"],loaded:!1},commonCaptcha:{name:"CommonCaptcha",url:p+u,deps:["vendor"],loaded:!1},commonCreativeCaptcha:{name:"CommonCreativeCaptcha",url:p+s,deps:["vendor"],loaded:!1}},f=new Promise(function(o,n){setTimeout(function(){o()},1e3);try{var t=new XMLHttpRequest;t.open("GET","//clue.toutiao.com/public/clue/get-assets",!0),t.send(),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var n=JSON.parse(t.responseText);n.version.timestamp>e.timestamp?(e.loaded=!0,e.revison=n.version.revison,e.time=n.version.time,Object.keys(h).forEach(function(e){n.assets[e]&&(h[e].url=p+n.assets[e])}),console.log("[CLUE]","update latest!",n)):console.log("[CLUE]","old assets!",n)}o()}}catch(e){console.warn("加载错误",e),o()}});function w(e){var o=h[e];if(o){if(o.loadPromise)return o.loadPromise;if(window.Clue[o.name])return Promise.resolve();var n=f.then(function(){return Promise.all(o.deps.map(function(e){return w(e)}))}).then(function(){return new Promise(function(e,n){var t=document.createElement("script");t.onload=function(){o.loaded=!0,o.oldName&&window[o.oldName]&&(window.Clue[o.name]=window[o.oldName]),e()},t.onerror=function(e){o.loadPromise=null,n(e)},t.src=o.url,document.head.appendChild(t)})},function(e){return o.loadPromise=null,Promise.reject(e)});return o.loadPromise=n,n}}var C={},b=function(e,o,n){var t=C[e];if(t?t.callback.push(o):t=C[e]={loaded:!1,callback:[o]},n)return t.loaded=!0,r(t.callback.slice()),void(t.callback.length=0);var a=document.createElement("script");function r(e){for(var o=0;o<e.length;o++)try{e[o]()}catch(e){console.error("clue component loaded callback run error",e)}}if(a.onload=function(){var o=C[e];o.loaded=!0,o.callback.length>0&&(r(o.callback.slice()),o.callback.length=0)},a.onerror=function(){console.error("clue component load failed, url:",e);var o=C[e];o.loaded||(o.callback.length=0)},a.src=e,document.head.appendChild(a),!window.clueErrorLog)if(window.Raven){var l=new window.Raven.Client;window.clueRavenWithConf=window.clueRavenWithConf||l.config("//6dd9b7bd320e4bbd953709f666add07d@www.toutiaopage.com/alarm/590",{release:e}),window.clueErrorLog=function(e,o){return window.clueRavenWithConf.captureMessage(e,o)}}else window.clueErrorLog=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return console.error(o)}},y=function(e,o){if(e)switch(e){case"normalForm":b(v[e],o,!!window.ClueNormalFormApp);break;default:console.warn("nothing to load, type=",e)}},k=function(e,o,n){if(e)switch(e){case"lottery":w("lotteryOld").then(function(){new ClueLotteryApp({compId:o.compId||0,clueAccountId:o.clueAccountId||0,advId:o.advId||0,container:o.container||document.querySelector("body"),extraData:o.extraData})});break;case"phoneEvent":b(v[e],function(){window.phoneapp.createPhoneEvent({content:{type:o.type,normalPhoneNumber:o.normalPhoneNumber,smartPhoneContent:{instanceId:o.instanceId,phoneNumber:o.phoneNumber}},advToken:o.advToken,clueAccountId:o.clueAccountId||0},o.container)});break;case"consultEvent":b(v[e],function(){window.consultapp.createConsultEvent({consultType:o.consultType,link:o.link,consultId:o.consultId},o.container)});break;case"phone":b(v[e],function(){window.phoneapp.createPhone({content:{type:o.type,normalPhoneNumber:o.normalPhoneNumber,smartPhoneContent:{instanceId:o.instanceId,phoneNumber:o.phoneNumber}},appearance:{buttonBgColor:o.buttonBgColor,fontColor:o.fontColor,btnText:o.btnText},advToken:o.advToken,clueAccountId:o.clueAccountId||0},o.container)});break;case"creativeForm":b(v[e],function(){});break;case"normalForm":b(v[e],function(){(new window.ClueNormalFormApp).createById({container:o.container,data:o.data,externalSetting:o.externalSetting})},!!window.ClueNormalFormApp);break;case"commonCaptcha":case"commonCreativeCaptcha":b(v[e],function(){});break;case"paySDK":b(v[e],n);break;case"getClueLoader":return y;case"getClueUrl":return v}};return window&&(window.createClueComp||(window.createClueComp=k)),{version:e,load:w,createClueComp:k}}();
